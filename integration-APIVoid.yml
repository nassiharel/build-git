category: Data Enrichment & Threat Intelligence
commonfields:
  id: APIVoid
  version: -1
configuration:
- display: API KEY
  name: apikey
  required: true
  type: 4
- additionalinfo: If the percentage of detections is BELOW this value, the indicator
    is considered GOOD
  defaultvalue: "10"
  display: Good Reputation (Percentage)
  name: good
  required: true
  type: 0
- additionalinfo: If the percentage of detections is ABOVE this value, the indicator
    is considered SUSPICIOUS
  defaultvalue: "30"
  display: Suspicious Reputation (Percentage)
  name: suspicious
  required: true
  type: 0
- additionalinfo: If the percentage of detections is ABOVE this value, the indicator
    is considered BAD
  defaultvalue: "60"
  display: Bad Reputation (Percentage)
  name: bad
  required: true
  type: 0
- additionalinfo: Consider the indicator malicious if either "suspicious" or "bad"
  defaultvalue: suspicious
  display: Malicious
  name: malicious
  options:
  - suspicious
  - bad
  required: true
  type: 15
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.0.15
    packID: APIVoid
    packName: APIVoid
    packPropagationLabels:
    - all
    propagationLabels: []
    toServerVersion: ""
description: APIVoid wraps up a number of services such as ipvoid & urlvoid
detaileddescription: '[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/api-void)'
display: APIVoid
image: data:image/png;base64,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
name: APIVoid
script:
  commands:
  - arguments:
    - description: The IP to query.
      name: ip
      required: true
    description: Returns the reputation and extended context of the IP.
    name: apivoid-ip
    outputs:
    - contextPath: IP.Address
      description: IP address
      type: string
    - contextPath: IP.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: number
    - contextPath: IP.Geo
      description: ""
    - contextPath: IP.Geo.Country
      description: The country in which the IP address is located.
      type: string
    - contextPath: IP.Geo.Description
      description: Additional information about the location.
      type: string
    - contextPath: IP.Geo.Location
      description: 'The geolocation where the IP address is located, in the format:
        latitude:longitude.'
      type: string
    - contextPath: IP.Hostname
      description: The hostname that is mapped to this IP address.
      type: string
    - contextPath: IP.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: number
    - contextPath: DBotScore
      description: ""
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: APIVoid.IP.anonymity.is_hosting
      description: ""
      type: boolean
    - contextPath: APIVoid.IP.anonymity.is_proxy
      description: ""
      type: boolean
    - contextPath: APIVoid.IP.anonymity.is_tor
      description: ""
      type: boolean
    - contextPath: APIVoid.IP.anonymity.is_vpn
      description: ""
      type: boolean
    - contextPath: APIVoid.IP.anonymity.is_webproxy
      description: ""
      type: boolean
    - contextPath: APIVoid.IP.blacklists.detection_rate
      description: ""
      type: string
    - contextPath: APIVoid.IP.blacklists.detections
      description: ""
      type: number
    - contextPath: APIVoid.IP.blacklists.engines.detected
      description: ""
      type: boolean
    - contextPath: APIVoid.IP.blacklists.engines.elapsed
      description: ""
      type: string
    - contextPath: APIVoid.IP.blacklists.engines.engine
      description: ""
      type: string
    - contextPath: APIVoid.IP.blacklists.engines.reference
      description: ""
      type: string
    - contextPath: APIVoid.IP.blacklists.engines_count
      description: ""
      type: number
    - contextPath: APIVoid.IP.blacklists.scantime
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.isp
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.latitude
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.reverse_dns
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.longitude
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.country_calling_code
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.country_name
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.region_name
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.country_code
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.continent_name
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.continent_code
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.country_currency
      description: ""
      type: string
    - contextPath: APIVoid.IP.information.city_name
      description: ""
      type: string
    - contextPath: APIVoid.IP.ip
      description: ""
      type: string
  - arguments:
    - description: The Domain to query.
      name: domain
      required: true
    description: Returns the reputation of the domain.
    name: apivoid-domain
    outputs:
    - contextPath: Domain
      description: ""
    - contextPath: Domain.DNS
      description: A list of IP objects resolved by DNS.
      type: string
    - contextPath: Domain.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: number
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: string
    - contextPath: Domain.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: number
    - contextPath: DBotScore
      description: ""
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: APIVoid.Domain.alexa_top_100k
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.domain_length
      description: ""
      type: number
    - contextPath: APIVoid.Domain.server.isp
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.ip
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.latitude
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.reverse_dns
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.longitude
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.country_name
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.region_name
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.country_code
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.continent_name
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.continent_code
      description: ""
      type: string
    - contextPath: APIVoid.Domain.server.city_name
      description: ""
      type: string
    - contextPath: APIVoid.Domain.alexa_top_250k
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.alexa_top_10k
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.most_abused_tld
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.host
      description: ""
      type: string
    - contextPath: APIVoid.Domain.blacklists.detection_rate
      description: ""
      type: string
    - contextPath: APIVoid.Domain.blacklists.detections
      description: ""
      type: number
    - contextPath: APIVoid.Domain.blacklists.engines.confidence
      description: ""
      type: string
    - contextPath: APIVoid.Domain.blacklists.engines.detected
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.blacklists.engines.elapsed
      description: ""
      type: string
    - contextPath: APIVoid.Domain.blacklists.engines.engine
      description: ""
      type: string
    - contextPath: APIVoid.Domain.blacklists.engines.reference
      description: ""
      type: string
    - contextPath: APIVoid.Domain.blacklists.engines_count
      description: ""
      type: number
    - contextPath: APIVoid.Domain.blacklists.scantime
      description: ""
      type: string
    - contextPath: APIVoid.Domain.category.is_anonymizer
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.category.is_free_dynamic_dns
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.category.is_free_hosting
      description: ""
      type: boolean
    - contextPath: APIVoid.Domain.category.is_url_shortener
      description: ""
      type: boolean
  - arguments:
    - description: The URL to query.
      name: url
      required: true
    description: Returns the reputation of the URL.
    name: apivoid-url
    outputs:
    - contextPath: URL
      description: ""
    - contextPath: URL.Data
      description: The URL
      type: string
    - contextPath: URL.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: number
    - contextPath: URL.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: number
    - contextPath: DBotScore
      description: ""
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: APIVoid.URL.risk_score.result
      description: ""
      type: number
    - contextPath: APIVoid.URL.domain_blacklist.detections
      description: ""
      type: number
    - contextPath: APIVoid.URL.domain_blacklist.engines.detected
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.domain_blacklist.engines.name
      description: ""
      type: string
    - contextPath: APIVoid.URL.domain_blacklist.engines.reference
      description: ""
      type: string
    - contextPath: APIVoid.URL.geo_location.countries
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.isp
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.ip
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.latitude
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.longitude
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.hostname
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.country_name
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.region_name
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.country_code
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.continent_name
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.continent_code
      description: ""
      type: string
    - contextPath: APIVoid.URL.server_details.city_name
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.server
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.code
      description: ""
      type: number
    - contextPath: APIVoid.URL.response_headers.content-type
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.date
      description: ""
      type: date
    - contextPath: APIVoid.URL.response_headers.cache-control
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.host-header
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.status
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.x-redirect-by
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.expires
      description: ""
      type: date
    - contextPath: APIVoid.URL.response_headers.location
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.content-length
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.upgrade
      description: ""
      type: string
    - contextPath: APIVoid.URL.response_headers.connection
      description: ""
      type: string
    - contextPath: APIVoid.URL.security_checks.is_windows_exe_file_on_ipv4
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_credit_card_form
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_windows_exe_file_on_free_hosting
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_linux_elf_file_on_ipv4
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_linux_elf_file_on_free_hosting
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_masked_windows_exe_file
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_zip_on_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_masked_linux_elf_file
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_sinkholed_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_suspended_page
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_suspicious_file_extension
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_uncommon_clickable_url
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_suspicious_content
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_risky_geo_location
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_php_on_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_doc_on_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_doc_on_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_empty_page_title
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_login_form
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_robots_noindex
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_suspicious_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_windows_exe_file_on_free_dynamic_dns
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_most_abused_tld
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_linux_elf_file_on_free_dynamic_dns
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_suspicious_url_pattern
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_valid_https
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_exe_on_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_pdf_on_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_host_an_ipv4
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_domain_blacklisted
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_china_country
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_windows_exe_file
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_masked_file
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_email_address_on_url_query
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_phishing_heuristic
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_non_standard_port
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_linux_elf_file
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_defaced_heuristic
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.security_checks.is_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.dns_records.mx.records.country_code
      description: ""
      type: string
    - contextPath: APIVoid.URL.dns_records.ns.records.country_name
      description: ""
      type: string
    - contextPath: APIVoid.URL.dns_records.ns.records.ip
      description: ""
      type: string
    - contextPath: APIVoid.URL.dns_records.ns.records.isp
      description: ""
      type: string
    - contextPath: APIVoid.URL.dns_records.ns.records.target
      description: ""
      type: string
    - contextPath: APIVoid.URL.redirection.external
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.redirection.found
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.redirection.url
      description: ""
      type: string
    - contextPath: APIVoid.URL.url
      description: ""
      type: string
    - contextPath: APIVoid.URL.url_parts.host
      description: ""
      type: string
    - contextPath: APIVoid.URL.url_parts.host_nowww
      description: ""
      type: string
    - contextPath: APIVoid.URL.url_parts.path
      description: ""
      type: string
    - contextPath: APIVoid.URL.url_parts.port
      description: ""
      type: number
    - contextPath: APIVoid.URL.url_parts.query
      description: ""
      type: string
    - contextPath: APIVoid.URL.url_parts.scheme
      description: ""
      type: string
    - contextPath: APIVoid.URL.site_category.is_anonymizer
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.site_category.is_free_dynamic_dns
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.site_category.is_free_hosting
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.site_category.is_torrent
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.site_category.is_url_shortener
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.site_category.is_vpn_provider
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.web_page.description
      description: ""
      type: string
    - contextPath: APIVoid.URL.web_page.keywords
      description: ""
      type: string
    - contextPath: APIVoid.URL.web_page.title
      description: ""
      type: string
    - contextPath: APIVoid.URL.html_forms.credit_card_field_present
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.html_forms.email_field_present
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.html_forms.number_of_total_forms
      description: ""
      type: number
    - contextPath: APIVoid.URL.html_forms.number_of_total_input_fields
      description: ""
      type: number
    - contextPath: APIVoid.URL.html_forms.password_field_present
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.html_forms.two_text_inputs_in_a_form
      description: ""
      type: boolean
    - contextPath: APIVoid.URL.file_type.extension
      description: ""
      type: string
    - contextPath: APIVoid.URL.file_type.headers
      description: ""
      type: string
    - contextPath: APIVoid.URL.file_type.signature
      description: ""
      type: string
  - arguments:
    - default: true
      description: The IP to query.
      isArray: true
      name: ip
      required: true
    description: Returns the reputation of the IP.
    name: ip
    outputs:
    - contextPath: IP
      description: ""
    - contextPath: IP.Address
      description: IP address
      type: string
    - contextPath: IP.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: number
    - contextPath: IP.Geo
      description: ""
    - contextPath: IP.Geo.Country
      description: The country in which the IP address is located.
      type: string
    - contextPath: IP.Geo.Description
      description: Additional information about the location.
      type: string
    - contextPath: IP.Geo.Location
      description: 'The geolocation where the IP address is located, in the format:
        latitude:longitude.'
      type: string
    - contextPath: IP.Hostname
      description: The hostname that is mapped to this IP address.
      type: string
    - contextPath: IP.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: number
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
  - arguments:
    - default: true
      description: The Domain to query.
      isArray: true
      name: domain
      required: true
    description: Returns the reputation of the domain.
    name: domain
    outputs:
    - contextPath: Domain.DNS
      description: A list of IP objects resolved by DNS.
      type: string
    - contextPath: Domain.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: number
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: string
    - contextPath: Domain.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: number
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
  - arguments:
    - default: true
      description: The URL to query.
      isArray: true
      name: url
      required: true
    description: Returns the reputation of the URL.
    name: url
    outputs:
    - contextPath: URL.Data
      description: The URL
      type: string
    - contextPath: URL.DetectionEngines
      description: The total number of engines that checked the indicator.
      type: number
    - contextPath: URL.PositiveDetections
      description: The number of engines that positively detected the indicator as
        malicious.
      type: number
    - contextPath: URL.RiskScore
      description: ""
      type: number
    - contextPath: URL.Score
      description: ""
      type: string
    - contextPath: DBotScore
      description: ""
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
  - arguments:
    - description: Host to lookup.
      name: host
      required: true
    - auto: PREDEFINED
      defaultValue: A
      description: The DNS record type to lookup
      name: type
      predefined:
      - A
      - AAAA
      - MX
      - NS
      - DMARK
      - Reverse
      - TXT
      - ANY
      - CNAME
      - SOA
      - SRV
      - CAA
      required: true
    description: Gets DNS records of a host.
    name: apivoid-dns-lookup
    outputs:
    - contextPath: APIVoid.DNS
      description: ""
    - contextPath: APIVoid.DNS.items.host
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.class
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.ttl
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.type
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.ip
      description: ""
      type: string
    - contextPath: APIVoid.DNS.found
      description: ""
      type: boolean
    - contextPath: APIVoid.DNS.count
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.ipv6
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.pri
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.target
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.txt
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.entries
      description: ""
      type: unknown
    - contextPath: APIVoid.DNS.items.mname
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.rname
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.serial
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.refresh
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.retry
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.expire
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.minimum-ttl
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.weight
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.port
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.flags
      description: ""
      type: number
    - contextPath: APIVoid.DNS.items.tag
      description: ""
      type: string
    - contextPath: APIVoid.DNS.items.value
      description: ""
      type: string
  - arguments:
    - description: Host to lookup SSL.
      name: host
      required: true
    description: Get useful SSL information from a remote host
    name: apivoid-ssl-info
    outputs:
    - contextPath: APIVoid.SSL
      description: ""
    - contextPath: APIVoid.SSL.found
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.fingerprint
      description: ""
      type: string
    - contextPath: APIVoid.SSL.deprecated_issuer
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.expired
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.valid_peer
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.host
      description: ""
      type: string
    - contextPath: APIVoid.SSL.name_match
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.debug_message
      description: ""
      type: string
    - contextPath: APIVoid.SSL.blacklisted
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.valid
      description: ""
      type: boolean
    - contextPath: APIVoid.SSL.details
      description: ""
    - contextPath: APIVoid.SSL.details.extensions
      description: ""
    - contextPath: APIVoid.SSL.details.extensions.authority_info_access
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.authority_key_identifier
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.basic_constraints
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.certificate_policies
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.crl_distribution_points
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.extended_key_usage
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.key_usage
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.extensions.subject_key_identifier
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.hash
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.issuer
      description: ""
    - contextPath: APIVoid.SSL.details.issuer.common_name
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.issuer.country
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.issuer.location
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.issuer.organization
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.issuer.organization_unit
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.issuer.state
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.signature
      description: ""
    - contextPath: APIVoid.SSL.details.signature.serial
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.signature.serial_hex
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.signature.type
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject
      description: ""
    - contextPath: APIVoid.SSL.details.subject.postal_code
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.street
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.name
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.organization_unit
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.state
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.organization
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.location
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.alternative_names
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.country
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.category
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.subject.common_name
      description: ""
      type: string
    - contextPath: APIVoid.SSL.details.validity
      description: ""
    - contextPath: APIVoid.SSL.details.validity.days_left
      description: ""
      type: number
    - contextPath: APIVoid.SSL.details.validity.valid_from
      description: ""
      type: date
    - contextPath: APIVoid.SSL.details.validity.valid_from_timestamp
      description: ""
      type: date
    - contextPath: APIVoid.SSL.details.validity.valid_to
      description: ""
      type: date
    - contextPath: APIVoid.SSL.details.validity.valid_to_timestamp
      description: ""
      type: date
    - contextPath: APIVoid.SSL.details.version
      description: ""
      type: string
  - arguments:
    - description: Email address to lookup
      name: email
      required: true
    description: Checks if an email address is disposable, if it has MX records, and
      more.
    name: apivoid-email-verify
    outputs:
    - contextPath: APIVoid.Email
      description: ""
    - contextPath: APIVoid.Email.email
      description: ""
      type: string
    - contextPath: APIVoid.Email.valid_format
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.username
      description: ""
      type: string
    - contextPath: APIVoid.Email.role_address
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.suspicious_username
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.dirty_words_username
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.domain
      description: ""
      type: string
    - contextPath: APIVoid.Email.valid_tld
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.disposable
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.has_mx_records
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.free_email
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.russian_free_email
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.china_free_email
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.suspicious_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.did_you_mean
      description: ""
      type: string
    - contextPath: APIVoid.Email.dirty_words_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.domain_popular
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.risky_tld
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.police_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.government_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.educational_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.should_block
      description: ""
      type: boolean
    - contextPath: APIVoid.Email.score
      description: ""
      type: number
  - arguments:
    - description: The host the check
      name: host
      required: true
    description: Check if a website is present on ThreatLog database
    name: apivoid-threatlog
    outputs:
    - contextPath: APIVoid.ThreatLog.detected
      description: ""
      type: boolean
    - contextPath: APIVoid.ThreatLog.host
      description: ""
      type: string
    - contextPath: APIVoid.ThreatLog.scantime
      description: ""
      type: string
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: string
  - arguments:
    - description: Domain to check
      name: domain
      required: true
    description: Detect if a domain (i.e google.com) is actually parked
    name: apivoid-parked-domain
    outputs:
    - contextPath: APIVoid.ParkedDomain.host
      description: ""
      type: string
    - contextPath: APIVoid.ParkedDomain.parked_domain
      description: ""
      type: boolean
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: string
  - arguments:
    - description: The domain to check
      name: domain
      required: true
    description: Get the registration date of a domain and the domain age in days
    name: apivoid-domain-age
    outputs:
    - contextPath: APIVoid.DomainAge.debug_message
      description: ""
      type: string
    - contextPath: APIVoid.DomainAge.domain_age_found
      description: ""
      type: boolean
    - contextPath: APIVoid.DomainAge.domain_age_in_days
      description: ""
      type: number
    - contextPath: APIVoid.DomainAge.domain_age_in_months
      description: ""
      type: number
    - contextPath: APIVoid.DomainAge.domain_age_in_years
      description: ""
      type: number
    - contextPath: APIVoid.DomainAge.domain_creation_date
      description: ""
      type: string
    - contextPath: APIVoid.DomainAge.domain_registered
      description: ""
      type: string
    - contextPath: APIVoid.DomainAge.host
      description: ""
      type: string
    - contextPath: Domain.CreationDate
      description: The date that the domain was created.
      type: date
    - contextPath: Domain.Name
      description: 'The domain name, for example: "google.com".'
      type: string
  - arguments:
    - description: URL to capture screenshot of
      name: url
      required: true
    description: Capture a high-quality screenshot of any website or URL
    name: apivoid-url-to-image
    outputs:
    - contextPath: File.Size
      description: The size of the file.
      type: number
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: string
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: string
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: string
    - contextPath: File.Name
      description: The name of the file.
      type: string
    - contextPath: File.SSDeep
      description: The SSDeep hash of the file.
      type: string
    - contextPath: File.EntryID
      description: The EntryID of the file.
      type: string
    - contextPath: File.Info
      description: Info regarding the file.
      type: string
    - contextPath: File.Type
      description: The type of the file.
      type: string
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: string
    - contextPath: File.Extension
      description: The extension of the file.
      type: string
  - arguments:
    - description: URL to create PDF of
      name: url
      required: true
    description: Convert an URL info high-quality and printable PDF document
    name: apivoid-url-to-pdf
    outputs:
    - contextPath: File.Size
      description: The size of the file.
      type: number
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: string
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: string
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: string
    - contextPath: File.Name
      description: The name of the file.
      type: string
    - contextPath: File.SSDeep
      description: The SSDeep hash of the file.
      type: string
    - contextPath: File.EntryID
      description: The EntryID of the file.
      type: string
    - contextPath: File.Info
      description: Info regarding the file.
      type: string
    - contextPath: File.Type
      description: The type of the file.
      type: string
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: string
    - contextPath: File.Extension
      description: The extension of the file.
      type: string
  - arguments:
    - description: URL to create PDF of
      name: url
      required: true
    description: Get the body of an html page after javascript has been executed
    name: apivoid-url-to-html
    outputs:
    - contextPath: File.Size
      description: The size of the file.
      type: number
    - contextPath: File.SHA1
      description: The SHA1 hash of the file.
      type: string
    - contextPath: File.SHA256
      description: The SHA256 hash of the file.
      type: string
    - contextPath: File.SHA512
      description: The SHA512 hash of the file.
      type: string
    - contextPath: File.Name
      description: The name of the file.
      type: string
    - contextPath: File.SSDeep
      description: The SSDeep hash of the file.
      type: string
    - contextPath: File.EntryID
      description: The EntryID of the file.
      type: string
    - contextPath: File.Info
      description: Info regarding the file.
      type: string
    - contextPath: File.Type
      description: The type of the file.
      type: string
    - contextPath: File.MD5
      description: The MD5 hash of the file.
      type: string
    - contextPath: File.Extension
      description: The extension of the file.
      type: string
  - arguments:
    - description: The host to check
      name: host
      required: true
    description: A smart API that accurately checks a website's trustworthiness.
    name: apivoid-site-trustworthiness
    outputs:
    - contextPath: APIVoid.SiteTrust.domain_blacklist.detections
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.domain_blacklist.engines.detected
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.domain_blacklist.engines.name
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.domain_blacklist.engines.reference
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.geo_location.countries
      description: ""
    - contextPath: APIVoid.SiteTrust.domain_age.domain_age_in_days
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.domain_age.domain_age_in_months
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.domain_age.domain_age_in_years
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.domain_age.domain_creation_date
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.domain_age.found
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.server_details.isp
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.ip
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.latitude
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.server_details.longitude
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.server_details.hostname
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.country_name
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.region_name
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.country_code
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.continent_name
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.continent_code
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.server_details.city_name
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.server
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.content-encoding
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.code
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.response_headers.content-type
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.date
      description: ""
      type: date
    - contextPath: APIVoid.SiteTrust.response_headers.vary
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.status
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.x-amz-rid
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.content-length
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.response_headers.connection
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.host
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.security_checks.is_website_popular
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_suspended_site
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_domain_recent
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.security_checks.is_heuristic_pattern
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_sinkholed_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_risky_geo_location
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_empty_page_title
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_robots_noindex
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_suspicious_domain
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_most_abused_tld
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_valid_https
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_domain_blacklisted
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_email_configured
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_china_country
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_directory_listing
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.security_checks.is_free_email
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.trust_score.result
      description: ""
      type: number
    - contextPath: APIVoid.SiteTrust.dns_records
      description: ""
    - contextPath: APIVoid.SiteTrust.redirection.external
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.redirection.found
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.redirection.url
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.url_parts.host
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.url_parts.host_nowww
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.url_parts.path
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.url_parts.port
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.url_parts.query
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.url_parts.scheme
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.ecommerce_platform.is_magento
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.ecommerce_platform.is_opencart
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.ecommerce_platform.is_prestashop
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.ecommerce_platform.is_shopify
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.ecommerce_platform.is_woocommerce
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.ecommerce_platform.is_zencart
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.web_page.description
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.web_page.keywords
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.web_page.title
      description: ""
      type: string
    - contextPath: APIVoid.SiteTrust.targeted_brands.patagonia
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.rolex
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.timberland
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.hugoboss
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.moncler
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.longchamp
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.abercrombie
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.montblanc
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.carhartt
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.rayban
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.drmartens
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.hermes
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.oakley
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.michaelkors
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.louisvuitton
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.birkenstock
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.adidas
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.vans
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.ralphlauren
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.mulberry
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.converse
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.versace
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.ugg
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.nike
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.swarovski
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.peuterey
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.cartier
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.pandora
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.burberry
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.gucci
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.salomon
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.liujo
      description: ""
      type: boolean
    - contextPath: APIVoid.SiteTrust.targeted_brands.truereligion
      description: ""
      type: boolean
  dockerimage: demisto/python3:3.10.4.29342
  runonce: false
  script: |
    register_module_line('APIVoid', 'start', __line__())





    ''' IMPORTS '''
    import copy
    from base64 import b64decode

    # Disable insecure warnings
    requests.packages.urllib3.disable_warnings()

    ''' CONSTANTS '''
    DATE_FORMAT = '%Y-%m-%dT%H:%M:%SZ'
    API_ENDPOINT = 'https://endpoint.apivoid.com'
    GOOD = 10
    SUSPICIOUS = 30
    BAD = 60
    MALICIOUS = 'suspicious'


    class Client(BaseClient):
        """
        Client will implement the service API, and should not contain any Demisto logic.
        Should only do requests and return data.
        """
        def __init__(self, base_url, apikey, verify, proxy):
            self.apikey = apikey
            super().__init__(base_url, verify=verify, proxy=proxy)

        def test(self):

            # Use iprep & STATS as test parameter
            suffix = '/iprep/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'stats': ''}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_ip(self, ip):

            suffix = '/iprep/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'ip': ip}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_domain(self, domain):

            suffix = '/domainbl/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': domain}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_url(self, url):

            suffix = '/urlrep/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'url': url}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_dns(self, host, dns_type):

            suffix = '/dnslookup/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': host, 'action': f'dns-{dns_type.lower()}'}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_ssl(self, host):

            suffix = '/sslinfo/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': host}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_email_address(self, email):

            suffix = '/emailverify/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'email': email}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_threatlog(self, host):

            suffix = '/threatlog/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': host}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_parked_domain(self, domain):

            suffix = '/parkeddomain/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': domain}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def check_domain_age(self, domain):

            suffix = '/domainage/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': domain}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def screenshot(self, url):

            suffix = '/screenshot/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'url': url}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def url_to_pdf(self, url):

            suffix = '/urltopdf/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'url': url}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def url_to_html(self, url):

            suffix = '/urltohtml/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'url': url}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response

        def site_trust(self, host):

            suffix = '/sitetrust/v1/pay-as-you-go/'
            api_params = {'key': self.apikey, 'host': host}
            response = self._http_request(method='GET', url_suffix=suffix, params=api_params)
            return response


    def indicator_context(client, indicator, indicator_context_path, indicator_value_field, engines, detections):
        # DBot Information
        dbot_score = 0
        if engines != 0:
            detection_rate = (detections / engines) * 100

            if detection_rate < GOOD:
                dbot_score = 1
            if detection_rate > SUSPICIOUS:
                dbot_score = 2
            if detection_rate > BAD:
                dbot_score = 3

        if (MALICIOUS == "suspicious" and dbot_score >= 2) or (MALICIOUS == "bad" and dbot_score == 3):
            indicator['Malicious'] = {
                'Vendor': 'APIVoid',
                'Description': f"Detection rate of {indicator['PositiveDetections']}/{indicator['DetectionEngines']}"
            }

        return {
            indicator_context_path: indicator,
            'DBotScore': {
                'Score': dbot_score,
                'Vendor': 'APIVoid',
                'Indicator': indicator[indicator_value_field],
                'Type': 'ip'
            }
        }


    def test_module(client):

        result = client.test()

        if result.get('success'):
            return 'ok'
        else:
            return 'Test Failed: ' + str(result)


    def ip_command(client, args, reputation_only):

        ip = args.get('ip')
        raw_response = client.check_ip(ip)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        report = raw_response.get('data', {}).get('report', None)
        if report:
            engines = report.get('blacklists', {}).get('engines_count', 0)
            detections = report.get('blacklists', {}).get('detections', 0)

            # IP Information
            information = report.get('information', {})
            lat = information.get('latitude', None)
            lng = information.get('longitude', None)
            ip = {
                'Address': report['ip'],
                'Hostname': information.get('reverse_dns', None),
                'Geo': {
                    'Location': f'{lat}:{lng}' if lat and lng else None,
                    'Country': information.get('country_name', None),
                    'Description': information.get('isp', None),
                },
                'DetectionEngines': engines,
                'PositiveDetections': detections,
            }
            ec = indicator_context(client, ip, outputPaths['ip'], 'Address', engines, detections)

            if not reputation_only:
                ec['APIVoid.IP(val.ip && val.ip == obj.ip)'] = report

            md = tableToMarkdown(f'APIVoid information for {ip["Address"]}:', ip)

        else:
            ec = {}
            md = f'## No information for {ip}'

        return_outputs(md, ec, raw_response)


    def domain_command(client, args, reputation_only):

        domain = args.get('domain')
        raw_response = client.check_domain(domain)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        report = raw_response.get('data', {}).get('report', None)
        if report:
            engines = report.get('blacklists', {}).get('engines_count', 0)
            detections = report.get('blacklists', {}).get('detections', 0)

            # Domain Information
            domain = {
                'Name': report['host'],
                'DNS': report['host'],
                'DetectionEngines': engines,
                'PositiveDetections': detections,
            }

            ec = indicator_context(client, domain, outputPaths['domain'], 'Name', engines, detections)
            md = tableToMarkdown(f'APIVoid information for {domain["Name"]}:', domain)

            if not reputation_only:
                ec['APIVoid.Domain(val.domain && val.domain == obj.domain)'] = report

        else:
            ec = {}
            md = f'## No information for {domain}'

        return_outputs(md, ec, raw_response)


    def url_command(client, args, reputation_only):

        url = args.get('url')
        raw_response = client.check_url(url)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        report = raw_response.get('data', {}).get('report', None)
        if report:
            report['url'] = url

            engines = len(report.get('domain_blacklist', {}).get('engines', []))
            detections = report.get('domain_blacklist', {}).get('detections', 0)

            # URL Information
            url = {
                'Data': report['url'],
                'DetectionEngines': engines,
                'PositiveDetections': detections,
            }

            ec = indicator_context(client, url, outputPaths['url'], 'Data', engines, detections)
            md = tableToMarkdown(f'APIVoid information for {url["Data"]}:', url)

            if not reputation_only:
                ec['APIVoid.URL(val.url && val.url == obj.url)'] = report

        else:
            ec = {}
            md = f'## No information for {url}'

        return_outputs(md, ec, raw_response)


    def dns_lookup_command(client, args):

        host = args.get('host')
        dns_type = args.get('type')
        raw_response = client.check_dns(host, dns_type)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        records = raw_response.get('data', {}).get('records', None)
        entries = list()
        if records:
            md_data = copy.deepcopy(records)
            md_data['Host'] = host
            md_data['Type'] = dns_type

            records['host'] = host
            records['type'] = dns_type

            ec = {
                'APIVoid.DNS(val.host && val.type && val.host == obj.host && val.type == obj.type)': records,
            }
            md = tableToMarkdown(f'APIVoid DNS-{dns_type} information for {host}:', md_data)
            entries.append({
                'Type': entryTypes['note'],
                'ContentsFormat': formats['json'],
                'Contents': ec,
                'HumanReadable': md,
                'ReadableContentsFormat': formats['markdown'],
                'EntryContext': ec
            })

            for item in records.get('items', []):
                item_type = item.get('type', dns_type)
                md = tableToMarkdown(f'Information of {item_type} record from {host}:', item)
                entries.append({
                    'Type': entryTypes['note'],
                    'ContentsFormat': formats['json'],
                    'Contents': item,
                    'HumanReadable': md,
                    'ReadableContentsFormat': formats['markdown']
                })

            demisto.results(entries)
        else:
            demisto.results(f'## No information for {host}')


    def ssl_lookup_command(client, args):

        host = args.get('host')
        raw_response = client.check_ssl(host)

        if 'error' in raw_response:
            raise Exception(f"Command Failed: {raw_response['error']}")

        certificate = raw_response.get('data', {}).get('certificate', None)
        if certificate:
            md_data = copy.deepcopy(certificate)
            if 'details' in md_data:
                del md_data['details']

            certificate['host'] = host
            ec = {
                'APIVoid.SSL(val.host && val.host == obj.host)': certificate,
            }
            md = tableToMarkdown(f'APIVoid SSL Information for {host}:', md_data)

        else:
            ec = {}
            md = f'## No information for {host}'

        return_outputs(md, ec, raw_response)


    def email_address_command(client, args):

        email = args.get('email')
        raw_response = client.check_email_address(email)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {})
        if data:
            ec = {
                'APIVoid.Email(val.email && val.email == obj.email)': data
            }
            md = tableToMarkdown(f'APIVoid Email Information for {email}:', data)

        else:
            ec = {}
            md = f'## No information for {email}'

        return_outputs(md, ec, raw_response)


    def threatlog_command(client, args):

        host = args.get('host')
        raw_response = client.check_threatlog(host)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {}).get('threatlog', None)
        if data:
            ec = {
                'APIVoid.ThreatLog(val.host && val.host == obj.host)': data,
                'Domain': {
                    'Name': host,
                }
            }
            md = tableToMarkdown(f'APIVoid ThreatLog Information for {host}:', data)

        else:
            ec = {}
            md = f'## No information for {host}'

        return_outputs(md, ec, raw_response)


    def check_parked_domain_command(client, args):

        domain = args.get('domain')
        raw_response = client.check_parked_domain(domain)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {})
        if data:
            ec = {
                'APIVoid.ParkedDomain(val.host && val.host == obj.host)': data,
                'Domain': {
                    'Name': domain
                }
            }
            md = tableToMarkdown(f'APIVoid Parked Domain Information for {domain}:', data)

        else:
            ec = {}
            md = f'## No information for {domain}'

        return_outputs(md, ec, raw_response)


    def domain_age_command(client, args):

        domain = args.get('domain')
        raw_response = client.check_domain_age(domain)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {})
        if data:
            ec = {
                'APIVoid.DomainAge(val.host && val.host == obj.host)': data,
                'Domain': {
                    'Name': domain,
                    'CreationDate': data.get('domain_creation_date', None),
                }
            }
            md = tableToMarkdown(f'APIVoid Domain Age Information for {domain}:', data)

        else:
            ec = {}
            md = f'## No information for {domain}'

        return_outputs(md, ec, raw_response)


    def screenshot_command(client, args):

        url = args.get('url')
        raw_response = client.screenshot(url)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {})
        if data:

            # Create new file here
            file_name = url.replace("https", "").replace("http", "").replace("://", "").replace(".", "_")
            file_name += "_capture.png"
            demisto.results(fileResult(file_name, b64decode(data.get('base64_file', None))))


    def url_to_pdf_command(client, args):

        url = args.get('url')
        raw_response = client.url_to_pdf(url)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {})
        if data:

            # Create new file here
            file_name = url.replace("https", "").replace("http", "").replace("://", "").replace(".", "_")
            file_name += "_capture.pdf"
            demisto.results(fileResult(file_name, b64decode(data.get('base64_file', None))))


    def url_to_html_command(client, args):

        url = args.get('url')
        raw_response = client.url_to_html(url)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {})
        if data:

            # Create new file here
            file_name = url.replace("https", "").replace("http", "").replace("://", "").replace(".", "_")
            file_name += "_capture.html"
            demisto.results(fileResult(file_name, b64decode(data.get('base64_file', None))))


    def site_trust_command(client, args):

        host = args.get('host')
        raw_response = client.site_trust(host)

        if 'error' in raw_response:
            return_error("Command Failed: " + str(raw_response['error']))

        data = raw_response.get('data', {}).get('report', None)
        if data:
            data['host'] = host
            ec = {
                'APIVoid.SiteTrust(val.host && val.host == obj.host)': data,
            }
            md = tableToMarkdown(f'APIVoid Site Trustworthiness for {host}:', data)

            # Populate Domain information if available
            if data.get('domain_age', {}).get('found', False):
                ec['Domain'] = {
                    'Name': host,
                    'CreationDate': data.get('domain_age', {}).get('domain_creation_date', None),
                }
            if "ns" in data.get('dns_records', {}):
                name_servers = ",".join([
                    x.get('target', None) for x in data.get('dns_records', {}).get('ns', {}).get('records', [])
                ])
                ec['Domain']['NameServers'] = name_servers

        else:
            ec = {}
            md = f'## No information for {host}'

        return_outputs(md, ec, raw_response)


    def main():
        """
            PARSE AND VALIDATE INTEGRATION PARAMS
        """
        global GOOD, SUSPICIOUS, BAD, MALICIOUS
        params = demisto.params()
        # get the service API url (This is static for this service)
        base_url = API_ENDPOINT

        apikey = params.get('apikey', None)

        verify_certificate = not params.get('insecure', False)
        proxy = params.get('proxy', False)

        GOOD = int(params.get('good', 10))
        SUSPICIOUS = int(params.get('suspicious', 30))
        BAD = int(params.get('bad', 60))
        MALICIOUS = params.get('malicious', 'suspicious')
        command = demisto.command()

        LOG(f'Command being called is {demisto.command()}')
        try:
            client = Client(
                base_url,
                apikey,
                verify_certificate,
                proxy,
            )

            args = demisto.args()

            commands = {
                'apivoid-dns-lookup': dns_lookup_command,
                'apivoid-ssl-info': ssl_lookup_command,
                'apivoid-email-verify': email_address_command,
                'apivoid-threatlog': threatlog_command,
                'apivoid-parked-domain': check_parked_domain_command,
                'apivoid-domain-age': domain_age_command,
                'apivoid-url-to-image': screenshot_command,
                'apivoid-url-to-pdf': url_to_pdf_command,
                'apivoid-url-to-html': url_to_html_command,
                'apivoid-site-trustworthiness': site_trust_command,
            }

            if command == 'test-module':
                # This is the call made when pressing the integration Test button.
                result = test_module(client)
                demisto.results(result)

            elif command == 'ip':
                ip_command(client, args, True)

            elif command == 'apivoid-ip':
                ip_command(client, args, False)

            elif command == 'domain':
                domain_command(client, args, True)

            elif command == 'apivoid-domain':
                domain_command(client, args, False)

            elif command == 'url':
                url_command(client, args, True)

            elif command == 'apivoid-url':
                url_command(client, args, False)

            else:
                commands[command](client, args)

        # Log exceptions
        except Exception as e:
            return_error(f'Failed to execute {demisto.command()} command. Error: {str(e)}')


    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('APIVoid', 'end', __line__())
  subtype: python3
  type: python
system: true
