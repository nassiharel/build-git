comment: Show local accounts
commonfields:
  id: D2Users
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.0.5
    packID: D2
    packName: D2
    packPropagationLabels:
    - all
    propagationLabels: []
    toServerVersion: ""
engineinfo: {}
mainengineinfo: {}
name: D2Users
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  function usersUnix() {
    packOutput('cat /etc/passwd');
  }
  function usersWindows() {
    pack(wmi_query('select * from Win32_Account'), 'table');
  }
  try {
    if (env.OS === 'windows') {
      usersWindows();
    } else {
      usersUnix();
    }
  } catch (ex) {
    pack('Error: ' + ex);
  }
scripttarget: 1
system: true
tags:
- agent
- endpoint
type: javascript
