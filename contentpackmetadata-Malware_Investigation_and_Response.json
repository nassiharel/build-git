{
	"author": "Cortex XSOAR",
	"authorImage": "content/packs/Base/Author_image.png",
	"beta": false,
	"cacheVersn": 0,
	"categories": [
		"Endpoint"
	],
	"certification": "certified",
	"contentItemTypes": [
		"automation",
		"incidentfield",
		"incidenttype",
		"playbook",
		"layoutscontainer",
		"wizard"
	],
	"contentItems": {
		"automation": [
			{
				"description": "Parses attacks from context, and shows them according to the MITRE technique they use.",
				"name": "InvestigationDetailedSummaryParse",
				"tags": [
					"basescript"
				]
			},
			{
				"description": "Shows InvestigationDetailedSummaryParse results as a markdown table",
				"name": "InvestigationDetailedSummaryToTable",
				"tags": [
					"dynamic-section",
					"field-change-triggered"
				]
			},
			{
				"description": "Return a process list from the XDRIR integration.",
				"name": "ReadProcessesFileXDR",
				"tags": [
					"dynamic-section"
				]
			},
			{
				"description": "A cross-vendor wrapper script that triggers a ‘process kill’ command - i.e executes the proper kill process command according to the vendor: CrowdstrikeFalcon or Cortex XDR. The script will only fail when the kill process action fails for both vendors.",
				"name": "KillProcessWrapper",
				"tags": []
			},
			{
				"description": "Retrieves information from previously run reputation commands and aggregates their results.",
				"name": "InvestigationSummaryParse",
				"tags": []
			},
			{
				"description": "This Automation is a wrapper - \nIf the CrowdStrike key is present in context, ReadNetstatFile will be executed and displayed.\nElse, 'No data on Netstat found' will be displayed.",
				"name": "ReadNetstatFileWrapper",
				"tags": [
					"dynamic-section"
				]
			},
			{
				"description": "Creates a human readable table from ParseMalware context results.",
				"name": "InvestigationSummaryToTable",
				"tags": [
					"dynamic-section",
					"field-change-triggered"
				]
			},
			{
				"description": "This Automation is a wrapper - \nIf PaloAltoNetworksXDR is in context - ReadProcessesFileXDR will be executed and displayed. \nif CrowdStrike is in context -  ReadProcessesFile will be executed and displayed.\nelse 'No data on Process List found' will be displayed. ",
				"name": "ReadProcessFileWrapper",
				"tags": [
					"dynamic-section"
				]
			}
		],
		"classifier": null,
		"correlationrule": null,
		"dashboard": null,
		"genericfield": null,
		"generictype": null,
		"incidentfield": [
			{
				"description": "",
				"name": "Alerts and related info",
				"type": "grid"
			},
			{
				"description": "",
				"name": "Malware Detailed Investigation Summary",
				"type": "shortText"
			},
			{
				"description": "",
				"name": "Malware Investigation Summary",
				"type": "shortText"
			}
		],
		"incidenttype": [
			{
				"closureScript": "",
				"days": 0,
				"hours": 0,
				"name": "Malware Investigation and Response",
				"playbook": "Malware Investigation \u0026 Response Incident Handler",
				"weeks": 0
			}
		],
		"indicatorfield": null,
		"integration": null,
		"layoutscontainer": [
			{
				"description": "",
				"name": "Malware Investigation and Response"
			}
		],
		"list": null,
		"modelingrule": null,
		"parsingrule": null,
		"playbook": [
			{
				"description": "This playbook handles incident ingestion from the SIEM.\n  The user provides which EDR system to use, the field containing the incident ID or detection ID, and the field indicating whether the ingested item is an incident or detection.",
				"name": "Malware SIEM Ingestion - Get Incident Data"
			},
			{
				"description": "This playbook is triggered by a malware incident from an endpoint integration. It performs enrichment, detonation, and hunting within the organization, and remediation on the malware. \n The playbook also covers the SIEM ingestion flow in which the fetching integration is the SIEM and EDR integrations grab all additional data.\n Currently supported EDR integrations are XDR, CrowdStrike Falcon and Microsoft Defender for Endpoint. \n Currently supported SIEM integrations are QRadar and Splunk.",
				"name": "Malware Investigation \u0026 Response Incident Handler"
			},
			{
				"description": "This playbook sets the alert grid for the Malware Investigation \u0026 Response layout.",
				"name": "Malware Investigation and Response - Set Alerts Grid"
			}
		],
		"report": null,
		"reputation": null,
		"widget": null,
		"wizard": [
			{
				"dependency_packs": [
					{
						"min_required": 1,
						"name": "Endpoint Detection \u0026 Response",
						"packs": [
							{
								"display_name": "CrowdStrike Falcon",
								"name": "CrowdStrikeFalcon"
							},
							{
								"display_name": "Microsoft Defender for Endpoint",
								"name": "MicrosoftDefenderAdvancedThreatProtection"
							},
							{
								"display_name": "Palo Alto Networks Cortex XDR - Investigation and Response",
								"name": "CortexXDR"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Sandbox",
						"packs": [
							{
								"display_name": "Palo Alto Networks WildFire",
								"name": "Palo_Alto_Networks_WildFire"
							},
							{
								"display_name": "CrowdStrike Falcon X",
								"name": "CrowdStrikeFalconX"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Messaging",
						"packs": [
							{
								"display_name": "EWS Mail Sender",
								"name": "EWSMailSender"
							},
							{
								"display_name": "Gmail",
								"name": "Gmail"
							},
							{
								"display_name": "Microsoft Graph Mail",
								"name": "MicrosoftGraphMail"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Case Management",
						"packs": [
							{
								"display_name": "Atlassian Jira v2",
								"name": "Jira"
							},
							{
								"display_name": "ServiceNow v2",
								"name": "ServiceNow"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Data Enrichment \u0026 Threat Intelligence",
						"packs": [
							{
								"display_name": "Palo Alto Networks AutoFocus",
								"name": "AutoFocus"
							},
							{
								"display_name": "VirusTotal",
								"name": "VirusTotal"
							},
							{
								"display_name": "Mitre Attack v2",
								"name": "FeedMitreAttackv2"
							}
						]
					}
				],
				"description": "Welcome to the Deployment Wizard!  These steps will guide you through configuring your content pack so you'll have a working use case when the wizard finishes. Make sure to follow the steps in order, you can always continue the wizard where you left off. Learn more about this pack’s deployment.",
				"id": "Malware Use Case Adoption Wizard",
				"name": "Malware Use Case Adoption Wizard"
			},
			{
				"dependency_packs": [
					{
						"min_required": 1,
						"name": "Endpoint Detection \u0026 Response",
						"packs": [
							{
								"display_name": "CrowdStrike Falcon",
								"name": "CrowdStrikeFalcon"
							},
							{
								"display_name": "Microsoft Defender for Endpoint",
								"name": "MicrosoftDefenderAdvancedThreatProtection"
							},
							{
								"display_name": "Palo Alto Networks Cortex XDR - Investigation and Response",
								"name": "CortexXDR"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Sandbox",
						"packs": [
							{
								"display_name": "Palo Alto Networks WildFire",
								"name": "Palo_Alto_Networks_WildFire"
							},
							{
								"display_name": "CrowdStrike Falcon X",
								"name": "CrowdStrikeFalconX"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Messaging",
						"packs": [
							{
								"display_name": "EWS Mail Sender",
								"name": "EWSMailSender"
							},
							{
								"display_name": "Gmail",
								"name": "Gmail"
							},
							{
								"display_name": "Microsoft Graph Mail",
								"name": "MicrosoftGraphMail"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Case Management",
						"packs": [
							{
								"display_name": "Atlassian Jira v2",
								"name": "Jira"
							},
							{
								"display_name": "ServiceNow v2",
								"name": "ServiceNow"
							}
						]
					},
					{
						"min_required": 0,
						"name": "Data Enrichment \u0026 Threat Intelligence",
						"packs": [
							{
								"display_name": "Palo Alto Networks AutoFocus",
								"name": "AutoFocus"
							},
							{
								"display_name": "VirusTotal",
								"name": "VirusTotal"
							},
							{
								"display_name": "Mitre Attack v2",
								"name": "FeedMitreAttackv2"
							}
						]
					}
				],
				"description": "Welcome to the Deployment Wizard!  These steps will guide you through configuring your content pack so you'll have a working use case when the wizard finishes. Make sure to follow the steps in order, you can always continue the wizard where you left off. Learn more about this pack’s deployment.",
				"id": "Malware Use Case Adoption Wizard",
				"name": "Malware Use Case Adoption Wizard"
			}
		],
		"xsiamdashboard": null,
		"xsiamreport": null
	},
	"created": "2022-05-31T21:49:33Z",
	"currentVersion": "1.5.6",
	"definitionId": "",
	"dependencies": {
		"AutoFocus": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "2.0.21",
			"name": "AutoFocus"
		},
		"Base": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.31.8",
			"name": "Base"
		},
		"CommonPlaybooks": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "2.2.9",
			"name": "Common Playbooks"
		},
		"CommonScripts": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.7.14",
			"name": "Common Scripts"
		},
		"CommonTypes": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "3.2.39",
			"name": "Common Types"
		},
		"CortexXDR": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "4.7.3",
			"name": "Palo Alto Networks Cortex XDR - Investigation and Response"
		},
		"CrowdStrikeFalcon": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.8.8",
			"name": "CrowdStrike Falcon"
		},
		"CrowdStrikeFalconX": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.2.9",
			"name": "CrowdStrike FalconX"
		},
		"EWSMailSender": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.1.10",
			"name": "EWS Mail Sender"
		},
		"FeedMitreAttackv2": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.1.3",
			"name": "MITRE ATT\u0026CK"
		},
		"Gmail": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.1.19",
			"name": "Gmail"
		},
		"Jira": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "2.0.7",
			"name": "Atlassian Jira"
		},
		"MailSenderNew": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.0.6",
			"name": "Mail Sender (New)"
		},
		"Malware": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": true,
			"minVersion": "1.4.1",
			"name": "Malware Core"
		},
		"MicrosoftDefenderAdvancedThreatProtection": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.11.5",
			"name": "Microsoft Defender for Endpoint"
		},
		"MicrosoftGraphMail": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "1.1.21",
			"name": "Microsoft Graph Mail"
		},
		"Palo_Alto_Networks_WildFire": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "2.1.5",
			"name": "Palo Alto Networks WildFire"
		},
		"ServiceNow": {
			"author": "Cortex XSOAR",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "2.3.15",
			"name": "ServiceNow"
		},
		"VirusTotal": {
			"author": "VirusTotal",
			"certification": "certified",
			"mandatory": false,
			"minVersion": "2.4.4",
			"name": "VirusTotal"
		}
	},
	"deprecated": false,
	"description": "Accelerate the investigation of your endpoint malware alerts and incidents and trigger containment activities quickly.",
	"downloads": 1305,
	"eulaLink": "https://github.com/demisto/content/blob/master/LICENSE",
	"fromServerVersion": "6.5.0",
	"general": [
		"generalFieldCertified",
		"generalFieldByCortexXSOAR",
		"generalFieldFree",
		"generalFieldSupportIncluded"
	],
	"id": "MalwareInvestigationAndResponse",
	"installMessage": "",
	"integrations": [
		{
			"imagePath": "content/packs/CortexXDR/CortexXDR-IOC_image.png",
			"name": "Cortex XDR - IOC"
		},
		{
			"imagePath": "content/packs/CortexXDR/CortexXDR-XQLQueryEngine_image.png",
			"name": "Cortex XDR - XQL Query Engine"
		},
		{
			"imagePath": "content/packs/CortexXDR/CortexXDR-IR_image.png",
			"name": "Palo Alto Networks Cortex XDR - Investigation and Response"
		},
		{
			"imagePath": "content/packs/CrowdStrikeFalcon/CrowdstrikeFalcon_image.png",
			"name": "CrowdStrike Falcon"
		},
		{
			"imagePath": "content/packs/MicrosoftDefenderAdvancedThreatProtection/MicrosoftDefenderAdvancedThreatProtection_image.png",
			"name": "Microsoft Defender for Endpoint"
		}
	],
	"itemVersion": "1.5.6",
	"keywords": [],
	"legacy": true,
	"name": "Malware Investigation and Response",
	"packID": "MalwareInvestigationAndResponse",
	"packName": "",
	"premium": false,
	"previewOnly": false,
	"price": 0,
	"propagationLabels": [
		"all"
	],
	"rawKeywords": null,
	"rawTags": null,
	"rawUseCases": null,
	"readme": "Malware threat is one of the most common cybersecurity challenges facing businesses today. It causes data breaches, hardware failures, and inoperable computers and system networks that can be extremely costly to recover.  \nMalware investigations require security teams to reconcile data from multiple security products like EDRs, sandboxes, malware analysis tools, and threat intelligence providers. \nManual investigation wastes valuable time when malware may be propagating within an organization.\n\nThe Malware Investigation \u0026 Response content pack accelerates the investigation process for endpoint malware incidents and alerts by collecting evidence of malicious behaviors from telemetry data available through EDRs and processing malware analysis reports through sandboxes. Incident layouts also include buttons to remediate activities quickly.  \n\nThe pack closely maps evidence to MITRE ATT\u0026CK to uncover evidence of:\n- Persistence (for example, registry and scheduled jobs)\n- Evasion or tampering (for example and service stop and process kill)\n- Lateral movement (for example, network connections and file share enumeration)\n- PowerShell abuse and command-line analysis\n- Digitally signed files\n\n## What Does This Pack Do?\n* Provides forensic data, including running processes and open network connections at alert detection time.\n* Retrieves files and detonates sandboxes.\n* Analyzes process command line strings to identify suspicious behavior.\n* Processes select sandbox reports and visualizes the results in layouts.\n* Extracts indicators and provides threat intelligence enrichment.\n* Tags malicious and benign indicators for allow and deny lists for threat prevention and false-positive management.\n* Mirrors incidents between the EDR and Cortex XSOAR and enables incident closure with the EDR.\n* Supports aggregating incidents from EDRs, including multiple alerts and files.\n* Supports fetching malware incidents either from the EDR product or from a SIEM solution.\n\n![Malware Investigation \u0026 Response Incident layout](https://raw.githubusercontent.com/demisto/content/832669c3d4da4f016e2c5ea8604f89bfe2d32a3f/Packs/MalwareInvestigationAndResponse/doc_files/Malware_Investigation_%26_Response_layout.png)\n\n\n## Getting Started / How to Set up the Pack\nFor better user experience and easier onboarding, use the [**Deployment Wizard**](https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-8/cortex-xsoar-admin/marketplace/content-pack-installation/install-a-content-pack/use-the-use-case-deployment-wizard) after installing the content pack on the Marketplace page in Cortex XSOAR (Available for version 6.8).\n\nFor manual configuration, it is recommended to configure your integration instance to use: \n- Primary Playbook: **Malware Investigation and Response Incident Handler**\n- Primary Incident Type: **Malware Investigation and Response**\n\nFor more information, visit our [Cortex XSOAR Developer Docs](https://xsoar.pan.dev/docs/reference/packs/malware-investigation-and-response).\n\n\n\n### Dependencies \u0026 Recommendations\nSupported EDRs (Choose at least one): \n- CrowdStrike Falcon\n- Cortex XDR\n- Microsoft Defender for Endpoint\n\nSupported Sandboxes (Optional):\n- Palo Alto WildFire\n- CrowdStrike FalconX\n\nSupported Case Management (Optional):\n- ServiceNow\n- Atlassian Jira\n",
	"searchRank": 10,
	"serverMaxVersion": "",
	"serverMinVersion": "6.5.0",
	"support": "xsoar",
	"supportDetails": {
		"email": "",
		"url": "https://www.paloaltonetworks.com/cortex"
	},
	"tags": [
		"Incident Response",
		"Trending",
		"Malware",
		"Getting Started",
		"Use Case"
	],
	"toServerVersion": "",
	"updated": "2022-07-17T22:10:00Z",
	"useCases": [
		"Malware",
		"Hunting",
		"Incident Response"
	],
	"version": -1,
	"versionInfo": "3281367",
	"videos": [
		"https://www.youtube.com/watch?v=DtGIefyoTao"
	]
}