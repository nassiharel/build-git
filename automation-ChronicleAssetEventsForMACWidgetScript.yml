comment: Displays the list of events fetched for an asset identified as a "ChronicleAsset"
  type of indicator, when its MAC address is passed as an asset identifier.
commonfields:
  id: ChronicleAssetEventsForMACWidgetScript
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 2.0.20
    packID: GoogleChronicleBackstory
    packName: Chronicle
    packPropagationLabels:
    - all
    propagationLabels: []
    toServerVersion: ""
dependson:
  must:
  - '|||gcb-list-events'
dockerimage: demisto/python3:3.10.4.28442
enabled: true
engineinfo: {}
mainengineinfo: {}
name: ChronicleAssetEventsForMACWidgetScript
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('ChronicleAssetEventsForMACWidgetScript', 'start', __line__())



  import traceback
  from typing import Any, Dict, Union


  def set_arguments_for_widget_view(indicator_data: Dict[str, Any]) -> Union[Dict[str, str], str]:
      args = {}
      chronicleasset_mac = indicator_data.get('CustomFields', {}).get('chronicleassetmac', '')
      if chronicleasset_mac:
          args = {
              'asset_identifier': chronicleasset_mac,
              'asset_identifier_type': 'MAC Address',
              'preset_time_range': 'Last 30 days'
          }
      return args


  def main() -> None:
      try:
          arguments = set_arguments_for_widget_view(demisto.args().get('indicator'))
          if not arguments:
              demisto.results('No MAC Address associated with the ChronicleAsset.')
          else:
              demisto.results(demisto.executeCommand('gcb-list-events', arguments))
      except Exception as e:
          demisto.error(traceback.format_exc())
          return_error(f'Could not load widget:\n{e}')


  # python2 uses __builtin__ python3 uses builtins
  if __name__ == '__builtin__' or __name__ == 'builtins':
      main()

  register_module_line('ChronicleAssetEventsForMACWidgetScript', 'end', __line__())
scripttarget: 0
subtype: python3
system: true
tags:
- dynamic-indicator-section
timeout: 300ns
type: python
